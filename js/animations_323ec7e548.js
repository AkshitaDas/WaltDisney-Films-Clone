$(document).ready((function(){gsap.registerPlugin(ScrollTrigger),ScrollTrigger.config({limitCallbacks:!0});const players=Array.from(document.querySelectorAll(".video-player")).map((p=>new Plyr(p)));function toggleNav(event){event.preventDefault(),$("#mainnav").toggleClass("active"),$(".nav-icon-contain").toggleClass("close"),$("#primarynav").attr("aria-expanded",(function(i,attr){return attr&&trapFocus(document.getElementById("mainnav")),"true"==attr?"false":"true"}))}$(document).on("click","button.navbar-toggler",toggleNav),$(document).on("click","nav .overlay",(function(event){event.preventDefault(),$("#mainnav").removeClass("active"),$(".nav-icon-contain").removeClass("close")}));const hero_scroll=gsap.timeline({scrollTrigger:{trigger:"#hero",start:"top top",end:"bottom top",scrub:!0,pin:!0,pinSpacing:!1}});$("#hero img").length>0&&hero_scroll.to("#hero img",{duration:2,opacity:.6,y:-200}),$("#hero video").length>0&&hero_scroll.to("#hero video",{duration:2,opacity:.6,y:-200},"<"),$("#hero-text").length>0&&hero_scroll.to("#hero-text",{duration:2,opacity:.6,y:"-150%"},"<");ScrollTrigger.create({trigger:".hero-contain",start:"top 10px",end:"bottom 50px",toggleClass:{targets:"#mainnav",className:"hero-nav"},id:"pin nav"});$(".carousel").on("slide.bs.carousel",(function(event){$(event.relatedTarget).find("[data-lazy-type]");const videos=$(event.currentTarget).find('video, [data-lazy-type="yt"]');videos.each((video=>{if("yt"==videos[video].dataset.lazyType){const pI=players.findIndex((p=>p.elements.container===videos[video]));players[pI].pause()}else videos[video].pause()}));const activeSlide=$(event.relatedTarget).find('[data-lazy-type="bg-video"]');activeSlide.length>0&&activeSlide[0].play()})),$(".copy-url").on("click",(function(e){const copied_link=$(this).data("url");document.addEventListener("copy",(function(e){e.clipboardData.setData("text/plain",copied_link),e.preventDefault()}),!0),document.execCommand("copy")})),$('[data-toggle="popover"]').popover();function lazyLoadBgVideo(element){const el=$(element),stream=el.find("[data-bg-src-stream]"),src_stream=stream.data("bg-src-stream"),hd=el.find("[data-bg-src-hd]"),src_hd=hd.data("bg-src-hd"),sd=el.find("[data-bg-src-sd]"),src_sd=sd.data("bg-src-sd");stream.attr("src",src_stream),hd.attr("src",src_hd),sd.attr("src",src_sd),el[0].load(),el[0].play()}$("#tab-nav-sessions a").on("click",(function(){$(".row-session").addClass("active"),$("#no-sessions").removeClass("active")})),$("#toggleCategories").on("click",(function(event){$(".dropdown, .dropdown-menu").toggleClass("show");const dropdownEl=document.querySelector("#filter").querySelector(".dropdown");$("#toggleCategories").attr("aria-expanded",(function(i,attr){return attr&&trapFocus(dropdownEl),"true"==attr?"false":"true"}))})),$("#closeCategories").on("click",(function(event){$(".dropdown, .dropdown-menu").toggleClass("show")}));ScrollTrigger.batch("[data-lazy-type]",{start:"top 125%",end:"bottom -9999",once:!0,onEnter:(elements,triggers)=>{for(var i=0;i<elements.length;i++)lazyLoadBatch(elements[i])},onEnterBack:(elements,triggers)=>{for(var i=0;i<elements.length;i++)lazyLoadBatch(elements[i])}});function lazyLoadBatch(item){"image"==item.dataset.lazyType&&(item.src=item.dataset.lazySrc,item.classList.add("lazy-loaded")),"video"==item.dataset.lazyType&&(item.src=item.dataset.lazySrc),"bg-video"==item.dataset.lazyType&&lazyLoadBgVideo(item)}let sketchBGAnimations=gsap.utils.toArray(".sketch-bg-contain");for(let i=0;i<sketchBGAnimations.length;i++){let sketch=sketchBGAnimations[i];sketch.bg=sketch.querySelector(".sketch-bg"),sketch.image=sketch.bg.querySelector("img"),sketch.p=sketch.querySelector("p"),sketch.header=sketch.querySelector("h2"),sketch.btn=sketch.querySelector(".btn:not(#toggleCategories):not(.btn-process-nav)");const tl=gsap.timeline({scrollTrigger:{trigger:sketch,start:"top 80%",toggleActions:"restart none none none",id:"sketch"},defaults:{ease:"power4.out"}}).fromTo(sketch.image,{scale:1.4,opacity:0},{scale:1,opacity:1,duration:4},">").fromTo(sketch.header,{opacity:0,yPercent:25},{opacity:1,yPercent:0,duration:1},"<0.5").fromTo(sketch.p,{opacity:0,yPercent:10},{opacity:1,duration:1,yPercent:0},"<0.4");sketch.btn&&tl.fromTo(sketch.btn,{opacity:0},{opacity:1,duration:1},"<"),ScrollTrigger.create({trigger:sketch,start:"top bottom",onLeaveBack:()=>tl.pause(0)})}let linkboxFadeIn=gsap.utils.toArray(".link-box");for(var i=0;i<linkboxFadeIn.length;i++){let box=linkboxFadeIn[i];gsap.timeline({scrollTrigger:{trigger:box,start:"top 90%",toggleActions:"restart none none reverse"}}).fromTo(box,{opacity:0},{opacity:1,duration:.7})}let textFlip=gsap.utils.toArray(".text-flip");for(i=0;i<textFlip.length;i++){let row=textFlip[i];row.overlay=row.querySelector(".animate-overlay"),row.header=row.querySelector("h3"),row.p=row.querySelector("p"),row.btn=row.querySelector(".btn"),row.line=row.querySelector(".header-line"),row.social=row.querySelector(".social-icons-contain");const tl=gsap.timeline({scrollTrigger:{trigger:row,start:"top 80%",end:"top 100%",toggleActions:"restart none none none"},defaults:{ease:"power4.out"}}).to(row.overlay,{scaleX:0,duration:2},">");i%2==0?(tl.fromTo(row.header,{opacity:0,xPercent:25},{opacity:1,xPercent:0,duration:1},"<0.5"),tl.fromTo(row.p,{opacity:0,xPercent:10},{opacity:1,duration:1,xPercent:0},"<0.4")):(tl.fromTo(row.header,{opacity:0,xPercent:-25},{opacity:1,xPercent:0,duration:1},"<0.5"),tl.fromTo(row.p,{opacity:0,xPercent:-10},{opacity:1,duration:1,xPercent:0},"<0.4")),row.btn&&tl.fromTo(row.btn,{opacity:0},{opacity:1,duration:1},"<"),row.line&&tl.fromTo(row.line,{opacity:0,yPercent:5},{opacity:1,duration:.5,yPercent:0},"<"),row.social&&tl.fromTo(row.social,{opacity:0,xPercent:10},{opacity:1,duration:1,xPercent:0},"<0.2"),ScrollTrigger.create({trigger:row,start:"top bottom",onLeaveBack:()=>tl.pause(0)})}if(document.querySelectorAll(".perks-contain").length>0){gsap.timeline({scrollTrigger:{trigger:".perks-contain",start:"top 80%",end:"bottom 10%",toggleActions:"restart none none reverse"},defaults:{ease:"power4.out"}}).fromTo(".perk",{yPercent:10,opacity:0},{yPercent:0,opacity:1,duration:1,stagger:.2}).fromTo(".perk p",{opacity:0},{opacity:1,duration:.5,stagger:.2},"<0.2")}if(document.querySelectorAll(".copy").length>0&&gsap.utils.toArray(".copy").forEach(((copy,i)=>{copy.p=copy.querySelector("p"),copy.header=copy.querySelector("h2"),copy.btn=copy.querySelector(".btn");const tl=gsap.timeline({scrollTrigger:{trigger:copy,start:"top 80%",end:"bottom 10%",toggleActions:"restart none none reverse"},defaults:{ease:"power4.out"}}).fromTo(copy.header,{opacity:0,yPercent:25},{opacity:1,yPercent:0,duration:1},"<").fromTo(copy.p,{opacity:0,yPercent:10},{opacity:1,duration:1,yPercent:0},"<0.4");copy.btn&&tl.fromTo(copy.btn,{opacity:0},{opacity:1,duration:1},"<"),ScrollTrigger.create({trigger:copy,start:"top bottom",onLeaveBack:()=>tl.pause(0)})})),document.querySelectorAll(".questions").length>0){gsap.timeline({scrollTrigger:{trigger:".questions",start:"top 80%",end:"bottom 10%",toggleActions:"restart none none none"},defaults:{ease:"power4.out"}}).fromTo(".question",{opacity:0,yPercent:10},{opacity:1,duration:.7,yPercent:0,stagger:.1})}if(document.querySelectorAll("div.stay-connected").length>0){gsap.timeline({scrollTrigger:{trigger:".link-box-contain .stay-connected",start:"top 90%",end:"bottom 10%",toggleActions:"restart none none reverse"}}).fromTo(".stay-connected h3",{autoAlpha:0,xPercent:25},{autoAlpha:1,xPercent:0,duration:1},"<0.5").fromTo(".stay-connected p",{autoAlpha:0,xPercent:10},{autoAlpha:1,duration:1,xPercent:0,stagger:.3},"<0.4").fromTo(".stay-connected .social-icons",{autoAlpha:0,xPercent:10},{autoAlpha:1,duration:1,xPercent:0,stagger:.3},"<0.2").fromTo(".stay-connected .header-line",{autoAlpha:0,yPercent:5},{autoAlpha:1,duration:.5,yPercent:0},"<").timeScale(1.5)}if(document.querySelectorAll(".event-item").length>0){gsap.timeline({scrollTrigger:{trigger:".event-item",start:"top 80%",end:"bottom 10%",toggleActions:"restart none none reverse"}}).fromTo(".event-item",{autoAlpha:0,yPercent:15},{autoAlpha:1,yPercent:0,duration:.4,stagger:.2})}var publicationFilterRefresh,roleFilterRefresh;if(document.querySelectorAll(".publication").length>0){let $typeFilters=$(".filter-type"),$boxes=$(".publication[data-publication-category]"),$typeStatus={paper:!0,talk:!0},$filterCategoriesSelected=[];$("#filter.publication-filter :checkbox").click((function(event){publicationFilterRefresh()})),$("#clearCategories").click((function(event){$filterCategoriesSelected=[],$("#filter .publication-categories :checkbox:checked").each((function(){this.checked=!1,$(".link-box").removeClass("filter-hide")})),$(".dropdown, .dropdown-menu").toggleClass("show")})),publicationFilterRefresh=()=>{if($("#noResults").addClass("filter-hide"),$filterCategoriesSelected=$("#filter .filter-category:checkbox:checked").map((function(){return this.value})).get(),$typeFilters.each((function(index,el){$typeStatus[el.value]=el.checked})),$(".link-box.publication").addClass("filter-hide"),$filterCategoriesSelected.length<1)$("#filter :checkbox:checked").each((function(){$('.link-box[data-type="'+$(this).val()+'"]').removeClass("filter-hide")}));else for(var category of $filterCategoriesSelected){var $filteredBoxes=$boxes.filter('[data-publication-category *= "'+category+'"]');for(var type in $typeStatus)$typeStatus[type]&&$filteredBoxes.filter('[data-type="'+type+'"]').removeClass("filter-hide")}ScrollTrigger.refresh(),document.getElementById("filter-contain").scrollIntoView({behavior:"smooth"}),0===$(".link-box.publication").not(".filter-hide").length&&$("#noResults").removeClass("filter-hide")}}if(document.querySelectorAll(".link-box.role[data-role-type]").length>0){$(".link-box.role[data-role-type]");const $roleFilters=$("#filter.roles-filter .filter-category"),$roleStatus={production:!0,technology:!0,studio:!0},params=window.location.search,param_type=new URLSearchParams(params).get("type");param_type&&(Object.keys($roleStatus).forEach((k=>{param_type!=k&&($roleStatus[k]=!1,$(`#filter.roles-filter :checkbox[value="${k}"]`).prop("checked",!1),$(`.link-box[data-role-type="${k}"]`).addClass("filter-hide"),ScrollTrigger.refresh())})),$roleStatus[param_type]=!0,$("#selected-categories").text(param_type)),$("#filter.roles-filter :checkbox").click((e=>roleFilterRefresh())),roleFilterRefresh=()=>{$("#noResults").addClass("filter-hide"),$roleFilters.each((function(index,el){$roleStatus[el.value]=el.checked})),$(".link-box.role").addClass("filter-hide"),$("#filter :checkbox:checked").each((function(){$(`.link-box[data-role-type="${$(this).val()}"]`).removeClass("filter-hide")})),ScrollTrigger.refresh();document.getElementById("filter-contain").scrollIntoView({behavior:"smooth"}),0===$(".link-box.role").not(".filter-hide").length&&$("#noResults").removeClass("filter-hide"),$roleStatus.production&&$roleStatus.technology&&$roleStatus.studio?$("#selected-categories").text("All"):$roleStatus.production&&$roleStatus.technology?$("#selected-categories").text("Production, Technology"):$roleStatus.production&&$roleStatus.studio?$("#selected-categories").text("Production, Studio"):$roleStatus.technology&&$roleStatus.studio?$("#selected-categories").text("Technology, Studio"):$roleStatus.production?$("#selected-categories").text("Production"):$roleStatus.technology?$("#selected-categories").text("Technology"):$roleStatus.studio?$("#selected-categories").text("Studio"):$("#selected-categories").text("None")}}if(document.querySelectorAll("#filter").length>0){ScrollTrigger.matchMedia({"(min-width: 825px)":function(){ScrollTrigger.create({trigger:"#filter",start:"top top",end:"+=9999999999",pin:!0,anticipatePin:1})},"(max-width: 824px)":function(){ScrollTrigger.create({trigger:"#filter",start:"top 49px",end:"+=9999999999",pin:!0,anticipatePin:1,toggleClass:{targets:"#mainnav",className:"filter-pinned"}})}}),ScrollTrigger.create({trigger:".contains-filter",start:"bottom 100",end:"+=9999999999",toggleClass:"pinned"})}if(document.querySelectorAll(".pillar").length>0){gsap.timeline({scrollTrigger:{trigger:".pillar",start:"top 80%",end:"bottom 10%",toggleActions:"restart none none reverse"},defaults:{ease:"power4.out"}}).fromTo(".pillar",{yPercent:10,opacity:0},{yPercent:0,opacity:1,duration:1,stagger:.2}).fromTo(".pillar .header-line",{scaleX:0,opacity:0},{scaleX:1,opacity:1,duration:1,stagger:.2},"<0.2").fromTo(".pillar p",{opacity:0},{opacity:1,duration:1,stagger:.2},"<")}const trapFocus=el=>{const focusableEls=el.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])'),firstFocusableEl=focusableEls[0],lastFocusableEl=focusableEls[focusableEls.length-1];el.addEventListener("keydown",(e=>{const isTabPressed="Tab"===e.key||9===e.keyCode,isSpacePressed="Space"===e.key||32===e.keyCode||" "===e.key;if("Escape"===e.key||27===e.keyCode)return document.querySelector("#mainnav.active")&&toggleNav(e),void(document.querySelector(".dropdown.show")&&($(".dropdown, .dropdown-menu").toggleClass("show"),$("#toggleCategories").attr("aria-expanded",!1)));isSpacePressed&&(e.preventDefault(),e.target.checked=!e.target.checked,e.target.classList.contains("filter-checkbox-roles")?roleFilterRefresh():e.target.classList.contains("filter-checkbox-publications")&&publicationFilterRefresh(),e.target.focus()),(isTabPressed||isSpacePressed)&&(e.shiftKey?document.activeElement===firstFocusableEl&&(lastFocusableEl.focus(),e.preventDefault()):document.activeElement===lastFocusableEl&&(firstFocusableEl.focus(),e.preventDefault()))}))}}));